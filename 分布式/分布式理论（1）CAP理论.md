# 分布式理论（1）CAP理论

![1584099973492](C:\Users\lf961\AppData\Roaming\Typora\typora-user-images\1584099973492.png)

## 什么是CAP定理

2000 年的时候，Eric Brewer 教授提出了 CAP 猜想，2年后，被 Seth Gilbert 和 Nancy Lynch 从理论上证明了猜想的可能性，从此，CAP 理论正式在学术上成为了分布式计算领域的公认定理。并深深的影响了分布式计算的发展。

CAP 理论告诉我们，一个分布式系统不可能同时满足一致性（C:Consistency)，可用性（A: Availability）和分区容错性（P：Partition tolerance）这三个基本需求，最多只能同时满足其中的2个。

| 选项                      | **描述**                                                     |
| ------------------------- | ------------------------------------------------------------ |
| C（Consistence）          | **一致性**，指数据在多个副本之间能够保持一致的特性（严格的一致性）。 |
| A（Availability）         | **可用性**，指系统提供的服务必须一直处于可用的状态，每次请求都能获取到非错的响应——但是不保证获取的数据为最新数据。 |
| P（Network partitioning） | **分区容错性**，分布式系统在遇到任何网络分区故障的时候，仍然能够对外提供满足一致性和可用性的服务，除非整个网络环境都发生了故障。 |

## 为什么只能3选2

| **组 合** | **分析结果**                                                 |
| --------- | ------------------------------------------------------------ |
| CA        | 满足原子和可用，放弃分区容错。说白了，就是一个整体的应用。   |
| CP        | 满足原子和分区容错，也就是说，要放弃可用。当系统被分区，为了保证原子性，必须放弃可用性，让服务停用。 |
| AP        | 满足原子和分区容错，也就是说，要放弃可用。当系统被分区，为了保证原子性，必须放弃可用性，让服务停用。 |



## 能不能解决3选2的问题

CAP 理论已经提出了 13 年，也许可以做些改变。

仔细想想，分区是百分之百出现的吗？如果不出现分区，那么就能够同时满足 CAP。如果出现了分区，可以根据策略进行调整。比如 C 不必使用那么强的一致性，可以先将数据存起来，稍后再更新，实现所谓的 “最终一致性”。

这个思路又是一个庞大的问题，同时也引出了第二个理论 Base 理论